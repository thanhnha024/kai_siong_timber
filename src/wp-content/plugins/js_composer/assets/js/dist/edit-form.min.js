_.isUndefined(window.vc)&&(window.vc={atts:{}}),function(a){"use strict";var b=Backbone.View.extend({events:{},$lg_offset_placeholder_value:!1,$lg_size_placeholder_value:!1,initialize:function(){_.bindAll(this,"setLgPlaceholders")},render:function(){return this},save:function(){var b=[];return this.$el.find(".vc_column_offset_field").each(function(){var c=a(this);c.is(":checkbox:checked")?b.push(c.attr("name")):c.is("select")&&""!==c.val()&&b.push(c.val())}),b},setLgPlaceholders:function(){var a=this.$lg_offset_placeholder_value.val().replace(/[^\d]/g,"");this.$lg_size.find("option:first").text(VcI8nColumnOffsetParam.inherit_default),this.$lg_offset.find("option:first").text(a?VcI8nColumnOffsetParam.inherit+a:"")}});vc.atts.column_offset={parse:function(a){return this.content().find("input.wpb_vc_param_value."+a.param_name).data("vcColumnOffset").save().join(" ")},init:function(c,d){a("[data-column-offset=\"true\"]",d).each(function(){var c=a(this);c.find(".wpb_vc_param_value").data("vcColumnOffset",new b({el:c}).render())})}}}(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),function(a){"use strict";var b,c,d;b=wp.media,c=ajaxurl.replace(/admin\-ajax\.php/,"images/wpspin_light.gif"),b.controller.VcCssSingleImage=b.controller.VcSingleImage.extend({setCssEditor:function(a){return a&&(this._css_editor=a),this},updateSelection:function(){var a,b=this.get("selection"),c=this._css_editor.getBackgroundImage();void 0!==c&&""!==c&&-1!==c&&(a=_.map(c.toString().split(/,/),function(a){return a=wp.media.model.Attachment.get(a),a.fetch(),a})),b.reset(a)}}),d=vc.CssEditor=Backbone.View.extend({attrs:{},layouts:["margin","border-width","padding"],positions:["top","right","bottom","left"],$field:!1,simplify:!1,$simplify:!1,events:{"click .vc_icon-remove":"removeImage","click .vc_add-image":"addBackgroundImage","change .vc_simplify":"changeSimplify"},initialize:function(){_.bindAll(this,"setSimplify")},render:function(a){return this.attrs={},this.$simplify=this.$el.find(".vc_simplify"),_.isString(a)&&this.parse(a),this},parse:function(a){a=a.split(/\s*(\.[^\{]+)\s*\{\s*([^\}]+)\s*\}\s*/g),a&&a[2]&&this.parseAtts(a[2].replace(/\s+!important/g,""))},addBackgroundImage:function(a){return(a&&a.preventDefault&&a.preventDefault(),window.vc_selectedFilters={},this.image_media)?this.image_media.open("vc_editor"):void(this.image_media=b({state:"vc_single-image",states:[new b.controller.VcCssSingleImage().setCssEditor(this)]}),this.image_media.on("toolbar:create:vc_single-image",function(a){this.createSelectToolbar(a,{text:window.i18nLocale.set_image})},this.image_media),this.image_media.state("vc_single-image").on("select",this.setBgImage),this.image_media.open("vc_editor"))},setBgImage:function(){!function(b,c){var d;d=[],a(".media-modal").addClass("processing-media"),b.each(function(a){d.push(a.get("id"))}),function(b,c){a.ajax({dataType:"json",type:"POST",url:window.ajaxurl,data:{action:"vc_media_editor_add_image",filters:window.vc_selectedFilters,ids:b,vc_inline:!0,_vcnonce:window.vcAdminNonce}}).done(function(b){var d,e,f,g;if("function"==typeof c){for(d=[],f=[],g=0;g<b.data.ids.length;g++)e=wp.media.model.Attachment.get(b.data.ids[g]),f.push(e.fetch()),d.push(e);a.when.apply(a,f).done(function(){c(d)})}}).fail(function(b){a(".media-modal-close").click(),window.vc&&window.vc.active_panel&&window.i18nLocale&&window.i18nLocale.error_while_saving_image_filtered&&vc.active_panel.showMessage(window.i18nLocale.error_while_saving_image_filtered,"error"),window.console&&window.console.warn&&window.console.warn("css_editor processImages error",b)}).always(function(){a(".media-modal").removeClass("processing-media")})}(d,function(d){if(!window.vc||!window.vc.active_panel)return!1;var d=_.map(d,function(a){return a.attributes}),d=(b.reset(d),_.map(b.models,function(a){return a.attributes})),e=vc.template(a("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom));c._css_editor.$el.find(".vc_background-image .vc_image").html(e(d[0])),a(".media-modal").removeClass("processing-media")})}(this.get("selection"),this)},setCurrentBgImage:function(b){var d,e,f=/([^\?]+)(\?id=\d+){0,1}/,g="";b.match(/^\d+$/)?(e=vc.template(a("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom)),this.$el.find(".vc_background-image .vc_image").html(e({url:c,id:b,css_class:"vc_preview"})),a.ajax({type:"POST",url:window.ajaxurl,data:{action:"wpb_single_image_src",content:b,size:"full",_vcnonce:window.vcAdminNonce},dataType:"html",context:this}).done(function(a){this.$el.find(".vc_ce-image").attr("src",a+"?id="+b).removeClass("vc_preview")})):b.match(f)&&(d=(f=b.split(f))[1],f[2]&&(g=f[2].replace(/[^\d]+/,"")),e=vc.template(a("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom)),this.$el.find(".vc_background-image .vc_image").html(e({url:d,id:g})))},changeSimplify:function(){_.debounce(this.setSimplify,100)()},setSimplify:function(){this.simplifiedMode(this.$simplify[0].checked)},simplifiedMode:function(b){b?(this.simplify=!0,this.$el.addClass("vc_simplified")):(this.simplify=!1,this.$el.removeClass("vc_simplified"),_.each(this.layouts,function(b){var c=a("[data-attribute="+(b="border-width"===b?"border":b)+"].vc_top");this.$el.find("[data-attribute="+b+"]:not(.vc_top)").val(c.val())},this))},removeImage:function(b){var c=a(b.currentTarget);b&&b.preventDefault&&b.preventDefault(),c.parent().remove()},getBackgroundImage:function(){return this.$el.find(".vc_ce-image").data("imageId")},parseAtts:function(a){var b=/(\d+\S*)\s+(\w+)\s+([\d\w#\(,]+)/,c=!1;_.map(a.split(";"),function(a){var d,a=a.split(/:\s/),e=a[1]||"",f=a[0]||"",e=e&&e.trim();f.match(new RegExp("^("+this.layouts.join("|").replace("-","\\-")+")$"))&&e?(1===(d=e.split(/\s+/g)).length?d=[d[0],d[0],d[0],d[0]]:2===d.length?(d[2]=d[0],d[3]=d[1]):3===d.length&&(d[3]=d[1]),_.each(this.positions,function(a,b){this.$el.find("[data-name="+f+"-"+a+"]").val(d[b])},this)):"background-size"===f?(c=e,this.$el.find("[name=background_style]").val(e)):"background-repeat"!==f||c?"background-image"===f?this.setCurrentBgImage(e.replace(/url\(([^\)]+)\)/,"$1")):"background"===f&&e?((a=e.split(/^([^\s]+)\s+url\(([^\)]+)\)([\d\w]+\s+[\d\w]+)?$/))&&a[1]&&this.$el.find("[name="+f+"_color]").val(a[1]),a&&a[2]&&this.setCurrentBgImage(a[2])):"border"===f&&e&&e.match(b)?(a=e.split(b),d=[a[1],a[1],a[1],a[1]],_.each(this.positions,function(a,b){this.$el.find("[name="+f+"_"+a+"_width]").val(d[b])},this),this.$el.find("[name=border_style]").val(a[2]),this.$el.find("[name=border_color]").val(a[3]).trigger("change")):-1!=f.indexOf("border")&&e?-1==f.indexOf("style")?-1==f.indexOf("color")?-1==f.indexOf("radius")?f.match(/^[\w\-\d]+$/)&&this.$el.find("[name="+f.replace(/\-+/g,"_")+"]").val(e):this.$el.find("[name=border_radius]").val(e):this.$el.find("[name=border_color]").val(e).trigger("change"):this.$el.find("[name=border_style]").val(e):f.match(/^[\w\-\d]+$/)&&e&&this.$el.find("[name="+f.replace(/\-+/g,"_")+"]").val(e):this.$el.find("[name=background_style]").val(e)},this)},save:function(){var a="";return this.attrs={},_.each(this.layouts,function(a){this.getFields(a)},this),this.getBackground(),this.getBorder(),(a=_.isEmpty(this.attrs)?a:".vc_custom_"+Date.now()+"{"+_.reduce(this.attrs,function(a,b,c){return b?a+c+": "+b+" !important;":a},"",this)+"}")&&vc.frame_window&&vc.frame_window.vc_iframe.setCustomShortcodeCss(a),a},getBackgroundImageSrc:function(){return this.$el.find(".vc_background-image img").attr("src")},getBackgroundColor:function(){return this.$el.find("[name=background_color]").val()},getBackgroundStyle:function(){return this.$el.find("[name=background_style]").val()},getBackground:function(){var a=this.getBackgroundColor(),b=this.getBackgroundImageSrc(),c=this.getBackgroundStyle();a&&b?this.attrs.background=a+" url("+b+")":a?this.attrs["background-color"]=a:b&&(this.attrs["background-image"]="url("+b+")"),c.match(/repeat/)?(this.attrs["background-position"]="0 0",this.attrs["background-repeat"]=c):c.match(/cover|contain/)&&(this.attrs["background-position"]="center",this.attrs["background-repeat"]="no-repeat",this.attrs["background-size"]=c),a.match(/^rgba/)&&(this.attrs["*background-color"]=a.replace(/\s+/,"").replace(/(rgb)a\((\d+)\,(\d+),(\d+),[^\)]+\)/,"$1($2,$3,$4)"))},getBorder:function(){var a=this.$el.find("[name=border_style]").val(),b=this.$el.find("[name=border_radius]").val(),c=this.$el.find("[name=border_color]").val();this.attrs["border-width"]&&this.attrs["border-width"].match(/^\d+\S+$/)?(this.attrs.border=this.attrs["border-width"]+" "+(a||"initial")+" "+c,this.attrs["border-width"]=void 0):_.each(["left","right","top","bottom"],function(b){this.attrs["border-"+b+"-width"]&&(c&&(this.attrs["border-"+b+"-color"]=c),a)&&(this.attrs["border-"+b+"-style"]=a)},this),b&&(this.attrs["border-radius"]=b)},getFields:function(a){var b=[];return this.simplify?this.getSimplifiedField(a):void(_.each(this.positions,function(c){var d=this.$el.find("[data-name="+a+"-"+c+"]").val().replace(/\s+/,"");(d=d.match(/^-?\d*(\.\d+){0,1}(%|in|cm|mm|em|rem|ex|pt|pc|px|vw|vh|vmin|vmax)$/)?d:isNaN(parseFloat(d))?"":parseFloat(d)+"px")&&d.length&&b.push({name:c,val:d})},this),_.each(b,function(b){var c="border-width"===a?"border-"+b.name+"-width":a+"-"+b.name;this.attrs[c]=b.val},this))},getSimplifiedField:function(a){var b=this.$el.find("[data-name="+a+"-top]").val().replace(/\s+/,"");(b=b.match(/^-?\d*(\.\d+){0,1}(%|in|cm|mm|em|rem|ex|pt|pc|px|vw|vh|vmin|vmax)$/)?b:isNaN(parseFloat(b))?"":parseFloat(b)+"px").length&&(this.attrs[a]=b)}}),vc.atts.css_editor={parse:function(a){return this.content().find("input.wpb_vc_param_value[name=\""+a.param_name+"\"]").data("vcFieldManager").save()},init:function(b,c){a("[data-css-editor=true]",this.content()).each(function(){var c,e,f=a(this),g=f.find("input.wpb_vc_param_value[name=\""+b.param_name+"\"]"),h=g.val();h||(e={bg_color:"background-color",padding:"padding",margin_bottom:"margin-bottom",bg_image:"background-image"},c=vc.edit_element_block_view.model.get("params"),h=(e=_.reduce(e,function(a,b,d){var e=c[d];return _.isUndefined(e)||!e.length?a:a+b+": "+(e="bg_image"===d?"url("+e+")":e)+";"},""))?".tmp_class{"+e+"}":""),g.data("vcFieldManager",new d({el:f}).render(h))}),vc.atts.colorpicker.init.call(this,b,c)}}}(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),function(a){"use strict";var b=Backbone.View.extend({events:{change:"setParams"},setParams:function(){var a,b=this.save(),b=this.$el.find("[value=\""+b+"\"]"),c=vc.edit_element_block_view.content(),d=this.$el;b.length&&(b=b.data("params"),a=[],_.each(b,function(b,d){var e,d=c.find("[name="+d+"].wpb_vc_param_value");d.length&&(d.unbind("change.vcParamsPreset"),(e=d.data("vcFieldManager"))&&e.render&&e.render(b),a.push(d),d.val(b).trigger("change"))}),_.each(a,function(a){a.bind("change.vcParamsPreset",function(a){_.isUndefined(a.extra_type)&&d.val("")})}))},render:function(){return this.setParams(),this},save:function(){return this.$el.val()}});vc.atts.params_preset={parse:function(b){return a("select[name="+b.param_name+"]",this.content()).val()},init:function(c,d){a(".vc_params-preset-select",d).each(function(){var c=a(this);_.isUndefined(c.data("fieldManager"))&&c.data("fieldManager",new b({el:c}).render())})}}}(window.jQuery),function(a){"use strict";new function(){a(".gallery_widget_attached_images_list",this.$view).off("click.removeImage").on("click.removeImage","a.vc_icon-remove",function(b){b.preventDefault();var b=a(this).closest(".edit_form_line"),c=(a(this).parent().remove(),[]);b.find(".added img").each(function(){c.push(a(this).attr("rel"))}),b.find(".gallery_widget_attached_images_ids").val(c.join(",")).trigger("change")}),a(".gallery_widget_attached_images_list").each(function(){var b=a(this);b.sortable({forcePlaceholderSize:!0,placeholder:"widgets-placeholder-gallery",cursor:"move",items:"li",update:function(){var c=[];a(this).find(".added img").each(function(){c.push(a(this).attr("rel"))}),b.closest(".edit_form_line").find(".gallery_widget_attached_images_ids").val(c.join(",")).trigger("change")}})})};var b=a("#vc_edit-form-tabs");b.length&&(a(".wpb-edit-form").addClass("vc_with-tabs"),b.find(".vc_edit-form-tab-control").removeClass("vc_active").eq(0).addClass("vc_active"),b.find("[data-vc-ui-element=\"panel-edit-element-tab\"]").removeClass("vc_active").eq(0).addClass("vc_active"),b.find(".vc_edit-form-link").on("click",function(c){var d=a(this);c.preventDefault(),b.find(".vc_active").removeClass("vc_active"),d.parent().addClass("vc_active"),a(d.attr("href")).addClass("vc_active").parents(".vc_panel-body").scrollTop(0)})),a(".vc_ui-panel .additembutton").click(function(){var b=a(this).parent().parent().next().find(".listitemwindow");b.css({display:"block",top:"220px"}),b.find("[name='item_type']").val("items"),b.find("[name='item_value'], [name='item_content'], [name='item_url'], [name='item_content_color'], [name='item_value_color'], [name='item_value_background_color'], [name='item_border_color']").val(""),b.draggable({handle:a(".vc_panel-heading")}),b.resizable({handles:"n, e, s, w, ne, se, sw, nw"})}),a(".cancel-item-options, .listitemwindow .vc_close").click(function(b){b.preventDefault(),a(".listitemwindow").css("display","none")}),a("#add-item-shortcode").click(function(b){b.preventDefault();var c=window.tinyMCE.get("wpb_tinymce_content"),d=c.getContent(),e=a("[name='additemwindow'] [name='item_content_color']"),f=a("[name='additemwindow'] [name='item_value_color']"),g=a("[name='additemwindow'] [name='item_value_background_color']"),h=a("[name='additemwindow'] [name='item_border_color']"),i="[item"+(a("[name='additemwindow'] [name='item_type']").length?" type=\""+a("[name='additemwindow'] [name='item_type']").val()+"\"":"")+(a("[name='additemwindow'] [name='item_value']").length?" value=\""+a("[name='additemwindow'] [name='item_value']").val()+"\"":"")+(a("[name='additemwindow'] [name='item_url']").length?" url=\""+a("[name='additemwindow'] [name='item_url']").val()+"\"":"")+(a("[name='additemwindow'] [name='item_url_target']").length?" url_target=\""+a("[name='additemwindow'] [name='item_url_target']").val()+"\"":"")+(a("[name='additemwindow'] [name='item_icon']").length?" icon=\""+a("[name='additemwindow'] [name='item_icon']").val()+"\"":"")+(""==e.length?"":" text_color=\""+e.val()+"\"")+(""==f.length?"":" value_color=\""+f.val()+"\"")+(""==g.length?"":" value_bg_color=\""+g.val()+"\"")+(""==h.length?"":" border_color=\""+h.val()+"\"")+"]"+a("[name='additemwindow'] [name='item_content']").val()+"[/item]";c.setContent(a(d).text()+i),a(".listitemwindow").css("display","none")}),a(".gallery_widget_attached_images_ids").change(function(){var b=a(this).val().split(","),c=0;parseInt(b[0])&&(c=b.length);var d=a(this).hasClass("carousel_images")?5:a(this).hasClass("slider_images")?3:4,e=a(".wpb_el_type_attach_images").nextAll();e.slice(0,30*d+1).css("display","none"),c&&(e.slice(0,c*d).css("display","block"),e.slice(30*d,30*d+1).css("display","block"))}),setTimeout(function(){a(".gallery_widget_attached_images_ids").trigger("change")},1),a(".vc_ui-panel [name^='testimonials_icon'], .vc_ui-panel [name^='testimonials_title'], .vc_ui-panel [name^='testimonials_author'], .vc_ui-panel [name^='testimonials_author_subtext']").parent().parent().css("display","none"),a(".vc_ui-panel [name='testimonials_count']").change(function(){var b=a(this),c=a(".vc_ui-panel [name$='29']").length;a(".vc_ui-panel [name^='testimonials_icon'], .vc_ui-panel [name^='testimonials_title'], .vc_ui-panel [name^='testimonials_author'], .vc_ui-panel [name^='testimonials_author_subtext']").parent().parent().css("display","none"),b.parent().parent().nextUntil("",":lt("+b.val()*c+")").css("display","block")}),setTimeout(function(){a("[name='testimonials_count']").trigger("change")},1),a(".vc_ui-panel [name^='icon_type'], .vc_ui-panel [name^='icon_url'], .vc_ui-panel [name^='icon_target']").parent().parent().css("display","none"),a(".vc_ui-panel [name='icons_count']").change(function(){var b=a(this);a(".vc_ui-panel [name^='icon_type'], .vc_ui-panel [name^='icon_url'], .vc_ui-panel [name^='icon_target']").parent().parent().css("display","none"),b.parent().parent().nextUntil("",":lt("+3*b.val()+")").css("display","block")}),setTimeout(function(){a("[name='icons_count']").trigger("change")},1)}(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),function(a){"use strict";vc.atts.vc_grid_item={init:function(b){!0===vc_user_access().getState("grid_builder")||null===vc_user_access().getState("grid_builder")?this.content().find("[data-vc-shortcode-param-name=\""+b.param_name+"\"] [data-vc-grid-element=\"value\"]").on("change",function(){var c=a(this).val(),d=a(this).find("[value="+c+"]").data("vcLink");c&&a(this).parents("[data-vc-shortcode-param-name=\""+b.param_name+"\"]:first").find("[data-vc-grid-item=\"edit_link\"]").attr("href",d)}).trigger("change"):this.content().find("[data-vc-shortcode-param-name=\""+b.param_name+"\"] .vc_description").remove()},parse:function(a){return a=this.content().find("[data-vc-shortcode-param-name=\""+a.param_name+"\"] [data-vc-grid-element=\"value\"]"),a.length?a.val():""}}}(window.jQuery);